=== SYSTEMS LTD PROJECT DOCUMENT ===
Project: Provincial Citizen Services Portal
=== METADATA ===
{
  "document_type": "technical_runbook",
  "project_name": "Provincial Citizen Services Portal",
  "vendor": "Systems Ltd",
  "client": "Sindh Provincial Department",
  "tech_stack": "PHP/LAMP or .NET unspecified, maybe MySQL, front-end basic HTML/CSS",
  "project_code": "SL-7273-2020",
  "environment": "DR",
  "last_updated": "2024-12-13T18:36:36.847058",
  "version": "2.3",
  "support_contact": "Zainab Raza (QA Manager)"
}

=== CONTENT ===
## Systems Ltd. - Provincial Citizen Services Portal
[LEGACY: Required for Sindh Provincial Department integration]
 (SL-7273-2020) - DR Environment Runbo
```
# PHP/LAMP or .NET unspecified config - may be outdated
# Last verified: unknown
```
ok

**Document Version:** 1.3 (Last Updated: 2022-08-15)

**Project Code:** SL-7273-2020
**Client:** Sindh Provincial Department
**Environment:** DR (Disaster Recovery)

---

### 1. Introduction & Purpose

This document provides operational guidance for the Provincial Citizen Services Portal (PCSP) in the Disaster Recovery (DR) environment. It aims to assist technical personnel in maintaining, troubleshooting, and recovering the system in the event of a disaster affecting the primary production environment.

**NOTE:** This runbook is a living document and may contain outdated information. Always cross-reference with current system configurations and consult with subject matter experts where necessary.

---

### 2. System Overview (As Understood)

The Provincial Citizen Services Portal is intended to provide citizens of Sindh with online access to various government services. Key functionalities include:

*   **Permit Applications:** Submission and tracking of various permit requests.
*   **Complaint Filing:** Citizens can submit and monitor the status of their complaints.
*   **Application Status Tracking:** Real-time updates on the progress of submitted applications.

**Architecture:**
*   **Frontend:** Basic HTML, CSS. (Frameworks like Bootstrap were considered but not implemented due to scope changes).
*   **Backend:** Unspecified. Initial development was a mix of PHP and potentially some .NET components. The DR environment primarily utilizes PHP.
*   **Database:** MySQL. Specific version is unclear, but believed to be around MySQL 5.6.
*   **Web Server:** Apache (part of LAMP stack).

**Key Modules (as per initial requirements):**
*   User Registration & Authentication
*   Permit Application Module (Sub-modules for different permit types are not clearly defined in documentation)
*   Complaint Management Module
*   Status Tracking Dashboard
*   Admin Panel (Limited functionality in DR)

---

### 3. Environment Specifics (DR)

**Server Hostnames:**
*   `dr-web-01.sys.local` (Web Server)
*   `dr-db-01.sys.local` (Database Server)

**IP Addresses:**
*   `192.168.10.50` (dr-web-01)
*   `192.168.10.51` (dr-db-01)

**Database Credentials (DR):**
*   **Username:** `dr_user`
*   **Password:** `P@$$wOrd123!` (This password was hardcoded in some older scripts. **DO NOT USE IN PRODUCTION.**)

**Web Server Configuration:**
*   Apache version: 2.4.x (exact minor version unknown)
*   PHP version: 7.2.x (exact minor version unknown)
*   Document Root: `/var/www/html/pcsp_dr`

**Database Configuration:**
*   Database Name: `pcsp_dr_db`
*   Replication: Asynchronous replication from a staging environment (details are sparse).

---

### 4. Deployment & Configuration

**Initial Deployment:**
The initial deployment was performed manually by the development team. Subsequent updates have been ad-hoc.

**Configuration Files:**
*   `config.php` (located in `/var/www/html/pcsp_dr/includes/`) - Contains database credentials and other settings.
    *   **Example Snippet (config.php):**
        ```php
        <?php
        define('DB_HOST', 'dr-db-01.sys.local');
        define('DB_USER', 'dr_user');
        define('DB_PASS', 'P@$$wOrd123!'); // Hardcoded password
        define('DB_NAME', 'pcsp_dr_db');
        ?>
        ```
*   `.htaccess` files in various directories for URL rewriting.

**TODO:** Implement automated deployment scripts.

---

### 5. Monitoring & Alerting

**Current Monitoring:**
*   Basic server health checks (CPU, Memory, Disk Space) via Nagios (configured by the previous team).
*
<!-- TODO: Update diagram from outdated version -->
   Apache access logs and error logs.
*   MySQL slow query logs.

**Alerting:**
*   Alerts are sent to a distribution list: `ops-alerts@systems.com`.
*   **NOTE:** This distribution list may be outdated.

**TODO:** Implement more granular application-level monitoring and integrate with a modern alerting system.

---

### 6. Troubleshooting Procedures

**6.1. Application Not Responding**

1.  **Check Web Server Status:**
    *   SSH into `dr-web-01.sys.local` as `sysadmin`.
    *   Run: `sudo systemctl status apache2`
    *   If not running, start it: `sudo systemctl start apache2`

2.  **Check Database Connectivity:**
    *   From `dr-web-01.sys.local`, try to connect to the database:
        ```bash
        mysql -h dr-db-01.sys.local -u dr_user -p
        ```
        Enter the password `P@$$wOrd123!`.
    *   If connection fails, check database server status.

3.  **Review Application Logs:**
    *   Location: `/var/www/html/pcsp_dr/logs/`
    *   Look for `error.log` and `debug.log` (if enabled).
    *   **Tribal Knowledge:** For complex database errors, consult Asif. (Asif is no longer with Systems Ltd.)

**6.2. Database Errors**

1.  **Check MySQL Service:**
    *   SSH into `dr-db-01.sys.local` as `sysadmin`.
    *   Run: `sudo systemctl status mysql`
    *   If not running, start it: `sudo systemctl start mysql`

2.  **Review MySQL Error Logs:**
    *   Location: `/var/log/mysql/error.log`

3.  **Check Disk Space on Database Server:**
    *   Run: `df -h`
    *   Ensure sufficient space for database files.

**6.3. Slow Performance**

1.  **Identify Slow Queries:**
    *   Check MySQL slow query log (`/var/log/mysql/mysql-slow.log`).
    *   **TODO:** Implement query optimization strategies.

2.  **Check Server Resources:**
    *   Monitor CPU and memory usage on both web and database servers.
    *   `top` or `htop` can be used.

**6.4. User Authentication Issues**

*   This module is known to be unstable. If users cannot log in, it's likely due to a session management issue.
*   **Workaround:** Clear user session data from the database.
    *   Connect to the database and run: `DELETE FROM user_sessions WHERE expiry_time < NOW();`
    *   **WARNING:** This is a temporary fix and may disrupt active user sessions.

---

### 7. Emergency Procedures

**7.1. DR Failover (Simulated)**

**Scenario:** Primary production environment is unavailable.

1.  **Verify DR Environment Readiness:**
    *   Ensure `dr-web-01.sys.local` and `dr-db-01.sys.local` are accessible and services are running.
    *   **TODO:** Document a clear checklist for DR readiness verification.

2.  **Update DNS Records:**
    *   Point the public DNS records for the Provincial Citizen Services Portal to the IP address of `dr-web-01.sys.local` (`192.168.10.50`).
    *   **Contact:** Network Operations Team (contact details outdated, see Section 9).

3.  **Monitor System Load:**
    *   Closely monitor resource utilization on the DR servers after failov
[LEGACY: Required for Sindh Provincial Department integration]
er.

**7.2. Data Corruption (DR Environment)**

*   **Procedure:** Restore from the last known good backup.
*   **Backup Location:** `/mnt/backups/pcsp_dr/` (This path might be incorrect).
*   **Restore Process:**
    1.  Stop MySQL service.
    2.  Replace the data directory with the backup.
    3.  Start MySQL service.
*   **TODO:** Document specific backup and restore scripts. The current process relies on manual file copying.

---

### 8. Known Issues & Limitations

*   **Requirements Ambiguity:** The original project requirements were vague, leading to an incomplete understanding of certain functionalities. This is particularly evident in the permit application modules.
*   **No Usage Metrics:** There is no system in place to track user activity or system performance metrics.
*   **UX Feedback:** User experience feedback was not systematically collected during development.
*   **Version Mismatches:** Components may be running different versions than initially intended or documented. For example, the PHP version is likely older than the latest stable release.
*   **Deprecated Methods:** Some older PHP functions might still be in use, which could lead to future compatibility issues. `mysql_connect()` is still used in some legacy scripts.
*   **Inconsistent Formatting:** Code snippets within the application exhibit inconsistent formatting due to multiple developers working on it without strict coding standards.

---

### 9. Contact Information (Outdated)

*   **Primary Technical Contact (Development):**
    *   Name: Imran Khan
    *   Email: imran.khan@systems.com (Likely invalid)
    *   Phone: +92 300 1234567 (Likely invalid)

*   **Database Administrator (Development):**
    *   Name: Asif Ali
    *   Email: asif.ali@systems.com (Likely invalid)
    *   Phone: +92 333 7890123 (Likely invalid)

*   **Network Operations (for DNS changes):**
    *   Team Email: netops@systems.com (May be active)
    *   On-Call Phone: +92 21 111 222 333 (Extension 456)

---

### 10. Appendices

**10.1. Database Schema (Partial)**

*   **TODO:** Include a complete and up-to-date database schema diagram.
*   **Tribal Knowledge:** The `permits` table has a `status` field that can be 'pending', 'approved', 'rejected', or 'under_review'. The exact meaning of 'under_review' is not clearly defined.

**10.2. Server Configuration Details**

*   **TODO:** Add detailed configuration files for Apache, PHP, and MySQL.

---

**End of Runbook**